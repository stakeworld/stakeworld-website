"use strict";(self.webpackChunkstakeworld=self.webpackChunkstakeworld||[]).push([[35],{3905:(e,t,o)=>{o.d(t,{Zo:()=>l,kt:()=>h});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var d=n.createContext({}),p=function(e){var t=n.useContext(d),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},l=function(e){var t=p(e.components);return n.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,d=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(o),h=a,k=u["".concat(d,".").concat(h)]||u[h]||c[h]||r;return o?n.createElement(k,i(i({ref:t},l),{},{components:o})):n.createElement(k,i({ref:t},l))}));function h(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=u;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<r;p++)i[p]=o[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},4858:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=o(3117),a=(o(7294),o(3905));const r={id:"bootnode",title:"Bootnodes",description:"Setting up a bootnode",slug:"/bootnode",sidebar_position:4,keywords:["bootnode","bootnode server","wss","ws","polkadot.js","light client","polkadot","kusama","westend"]},i=void 0,s={unversionedId:"bootnode",id:"bootnode",title:"Bootnodes",description:"Setting up a bootnode",source:"@site/docs/bootnodes.mdx",sourceDirName:".",slug:"/bootnode",permalink:"/docs/bootnode",draft:!1,editUrl:"https://github.com/stakeworld/website/edit/master/docs/bootnodes.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"bootnode",title:"Bootnodes",description:"Setting up a bootnode",slug:"/bootnode",sidebar_position:4,keywords:["bootnode","bootnode server","wss","ws","polkadot.js","light client","polkadot","kusama","westend"]},sidebar:"tutorialSidebar",previous:{title:"Snapshot",permalink:"/docs/snapshot"},next:{title:"Database sizes",permalink:"/docs/dbsize"}},d={},p=[{value:"Accessing your own bootnode",id:"accessing-your-own-bootnode",level:2},{value:"Getting your key",id:"getting-your-key",level:2},{value:"Running the bootnode",id:"running-the-bootnode",level:2},{value:"Testing the bootnode connection",id:"testing-the-bootnode-connection",level:2}],l={toc:p};function c(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},'When you first start a node it has to find a way to find other nodes in the network. For that purpose you need "bootnodes". After the first bootnode is found it can use the connections of that node to continue expanding its network and be able to play its role in the network, like validate in the network.')),(0,a.kt)("h2",{id:"accessing-your-own-bootnode"},"Accessing your own bootnode"),(0,a.kt)("p",null,"The consensus is that bootnodes have to be accessible in three ways:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"p2p"),": the p2p port, which can be set by ",(0,a.kt)("inlineCode",{parentName:"li"},"--listen-addr /ip4/0.0.0.0/tcp/<port>"),". This port is not automatically set on a non validator node (for example an archive rpc node)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"p2p/ws"),": the websocket version, which can be set by ",(0,a.kt)("inlineCode",{parentName:"li"},"--listen-addr /ip4/0.0.0.0/tcp/<port>/ws"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"p2p/wss"),": the ",(0,a.kt)("em",{parentName:"li"},"secure")," websocket version. A ssl secured connection to the p2p/ws port which will have to be achieved by a proxy since the node itself has no way to include certificates. It is needed for light clients. See ",(0,a.kt)("a",{parentName:"li",href:"https://wiki.polkadot.network/docs/maintain-wss#secure-the-ws-port"},"here")," for info about setting this up.")),(0,a.kt)("h2",{id:"getting-your-key"},"Getting your key"),(0,a.kt)("p",null,"When you startup a node it creates its node-key in the ",(0,a.kt)("inlineCode",{parentName:"p"},"chains/<chain>/network/secret_ed25519")," file. You can also create a node-key by ",(0,a.kt)("inlineCode",{parentName:"p"},"polkadot key generate-node-key")," and use that node-key in the startup command line."),(0,a.kt)("p",null,"It is essential you backup the node-key, especially if it gets included in the polkadot binary because it gets hardcoded in the binary and needs to be recompiled to change."),(0,a.kt)("h2",{id:"running-the-bootnode"},"Running the bootnode"),(0,a.kt)("p",null,"Say we are running a polkadot node with ",(0,a.kt)("inlineCode",{parentName:"p"},"polkadot --chain polkadot --name dot-bootnode --listen-addr /ip4/0.0.0.0/tcp/30310 --listen-addr /ip4/0.0.0.0/tcp/30311/ws")," then we would have the p2p on port 30310 and p2p/ws on port 30311. For the p2p/wss port we need to setup a proxy, a dns name and a corresponding certificate. These concepts and example setups are described ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.polkadot.network/docs/maintain-wss#secure-the-ws-port"},"here"),". "),(0,a.kt)("h2",{id:"testing-the-bootnode-connection"},"Testing the bootnode connection"),(0,a.kt)("p",null,"Say we have above node running with dns name ",(0,a.kt)("inlineCode",{parentName:"p"},"dot-bootnode.stakeworld.io"),", proxied with a valid certificate and node-id ",(0,a.kt)("inlineCode",{parentName:"p"},"12D3KooWAb5MyC1UJiEQJk4Hg4B2Vi3AJdqSUhTGYUqSnEqCFMFg")," then we can check the connection by:"),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"You can add ",(0,a.kt)("inlineCode",{parentName:"p"},"-lsub-libp2p=trace")," on the end to get libp2p trace logging for debugging purposes.")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"p2p"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'polkadot --chain polkadot --base-path /tmp/node --name "Bootnode testnode" --reserved-only --reserved-nodes "/dns/dot-bootnode.stakeworld.io/tcp/30310/p2p/12D3KooWAb5MyC1UJiEQJk4Hg4B2Vi3AJdqSUhTGYUqSnEqCFMFg" --no-hardware-benchmarks \n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"ws"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'polkadot --chain polkadot --base-path /tmp/node --name "Bootnode testnode" --reserved-only --reserved-nodes "/dns/dot-bootnode.stakeworld.io/tcp/30311/ws/p2p/12D3KooWAb5MyC1UJiEQJk4Hg4B2Vi3AJdqSUhTGYUqSnEqCFMFg" --no-hardware-benchmarks \n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"wss"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'polkadot --chain polkadot --base-path /tmp/node --name "Bootnode testnode" --reserved-only --reserved-nodes "/dns/dot-bootnode.stakeworld.io/tcp/443/wss/p2p/12D3KooWAb5MyC1UJiEQJk4Hg4B2Vi3AJdqSUhTGYUqSnEqCFMFg" --no-hardware-benchmarks \n')))}c.isMDXComponent=!0}}]);