(self.webpackChunkstakeworld_io=self.webpackChunkstakeworld_io||[]).push([[953],{7838:(e,s,a)=>{"use strict";a.r(s),a.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"validate","title":"Validators","description":"Setting up a validator node","source":"@site/docs/validate.mdx","sourceDirName":".","slug":"/validate","permalink":"/docs/validate","draft":false,"unlisted":false,"editUrl":"https://github.com/stakeworld/website/edit/master/docs/validate.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"validate","title":"Validators","description":"Setting up a validator node","slug":"/validate","sidebar_position":2,"keywords":["validator setup","validator","validate","polkadot","kusama"]},"sidebar":"tutorialSidebar","next":{"title":"Snapshot","permalink":"/docs/snapshot"}}');var n=a(4848),o=a(8453),r=a(534);const i={id:"validate",title:"Validators",description:"Setting up a validator node",slug:"/validate",sidebar_position:2,keywords:["validator setup","validator","validate","polkadot","kusama"]},l=void 0,d={},c=[{value:"Stakeworld",id:"stakeworld",level:2},{value:"Set up your own polkadot node",id:"set-up-your-own-polkadot-node",level:2},{value:"Firewall",id:"firewall",level:2},{value:"Packages",id:"packages",level:2},{value:"Install polkadot",id:"install-polkadot",level:2},{value:"Database sync",id:"database-sync",level:2},{value:"check if ports are open",id:"check-if-ports-are-open",level:2},{value:"see cpu frequencies",id:"see-cpu-frequencies",level:2},{value:"get more disk space by limiting reserved space for root",id:"get-more-disk-space-by-limiting-reserved-space-for-root",level:2},{value:"get disk space information",id:"get-disk-space-information",level:2},{value:"rotatekeys",id:"rotatekeys",level:2},{value:"check session keys",id:"check-session-keys",level:2},{value:"see number of processes at a certain port",id:"see-number-of-processes-at-a-certain-port",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"stakeworld",children:"Stakeworld"}),"\n",(0,n.jsxs)(s.p,{children:["All of Stakeworld's validators operate on dedicated bare-metal hardware across various data centers. Each machine meets, and often exceeds, the minimum hardware requirements recommended by the ",(0,n.jsx)(s.a,{href:"https://wiki.polkadot.network/docs/maintain-guides-how-to-validate-polkadot#requirements",children:"Polkadot wiki"}),"."]}),"\n",(0,n.jsx)(r.A,{}),"\n",(0,n.jsx)(s.h2,{id:"set-up-your-own-polkadot-node",children:"Set up your own polkadot node"}),"\n",(0,n.jsx)(s.p,{children:"First you will need a working server setup. We advise an ubuntu 24.04 LTS on dedicated (bare bone) hardware."}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.a,{href:"https://wiki.polkadot.network/docs/maintain-guides-how-to-validate-kusama",children:"polkadot wiki"})," has a lot of good information about seting up a validator node."]}),"\n",(0,n.jsx)(s.p,{children:"It is wise to start setting your hostname (preferably matched bij the reverse dns on your provider), copying your ssh keys to your server and disable plain password authentication."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"vi /etc/hostname\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"yourhostname.yourhostdomain"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"vi /etc/ssh/sshd_config\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.code,{children:"PasswordAuthentication no"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"systemctl restart sshd.service\n"})}),"\n",(0,n.jsx)(s.h2,{id:"firewall",children:"Firewall"}),"\n",(0,n.jsxs)(s.admonition,{type:"tip",children:[(0,n.jsx)(s.p,{children:"Polkadot needs some ports open in the firewall, especially the p2p port"}),(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"30333: p2p port"}),"\n",(0,n.jsx)(s.li,{children:"9933: HTTP RPC"}),"\n",(0,n.jsx)(s.li,{children:"9944: WS RPC"}),"\n",(0,n.jsx)(s.li,{children:"9615: prometheus port"}),"\n"]})]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"ufw allow openssh\nufw enable\nufw allow from any port 30300:30399 proto tcp\nufw allow 30300:30399/tcp\n"})}),"\n",(0,n.jsx)(s.h2,{id:"packages",children:"Packages"}),"\n",(0,n.jsx)(s.p,{children:"Optionally lock the kernel updates so you have to manually upgrade them (which requires a restart)"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"apt-mark hold linux-generic linux-headers-generic linux-image-generic\n"})}),"\n",(0,n.jsx)(s.h2,{id:"install-polkadot",children:"Install polkadot"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"# Import the security@parity.io GPG key\ngpg --recv-keys --keyserver hkps://keys.mailvelope.com 9D4B2B6EB8F97156D19669A9FF0812D491B96798\ngpg --export 9D4B2B6EB8F97156D19669A9FF0812D491B96798 > /usr/share/keyrings/parity.gpg\n# Add the Parity repository and update the package index\necho 'deb [signed-by=/usr/share/keyrings/parity.gpg] https://releases.parity.io/deb release main' > /etc/apt/sources.list.d/parity.list\napt update\n# Install the `parity-keyring` package - This will ensure the GPG key\n# used by APT remains up-to-date\napt install parity-keyring\n# Install polkadot\napt install polkadot\n"})}),"\n",(0,n.jsx)(s.h2,{id:"database-sync",children:"Database sync"}),"\n",(0,n.jsx)(s.p,{children:"If you fire up a fresh polkadot it starts to sync from scratch, which will take a while. You can use warp sync to speed up the process or you can use a snapshot."}),"\n",(0,n.jsx)(s.h1,{id:"example-commands",children:"Example commands"}),"\n",(0,n.jsx)(s.p,{children:"Example ports and hosts used, change to your own setup."}),"\n",(0,n.jsx)(s.h2,{id:"check-if-ports-are-open",children:"check if ports are open"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"nc -vz 1.2.3.4 30333\n"})}),"\n",(0,n.jsx)(s.h2,{id:"see-cpu-frequencies",children:"see cpu frequencies"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"lscpu --all --extended\n"})}),"\n",(0,n.jsx)(s.h2,{id:"get-more-disk-space-by-limiting-reserved-space-for-root",children:"get more disk space by limiting reserved space for root"}),"\n",(0,n.jsx)(s.p,{children:"Default is 5% which is 50GB on a 1000 GB system, 0.1 (1GB) is more suitable."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"tune2fs -m0.1 /dev/<disk>\n"})}),"\n",(0,n.jsx)(s.h2,{id:"get-disk-space-information",children:"get disk space information"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"du -sh /home/polkadot/*\ndf -h\n"})}),"\n",(0,n.jsx)(s.h2,{id:"rotatekeys",children:"rotatekeys"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "author_rotateKeys", "params":[]}\' http://localhost:9944 > session.key\n'})}),"\n",(0,n.jsx)(s.h2,{id:"check-session-keys",children:"check session keys"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "author_hasSessionKeys", "params":["<session key 0x.....>"]}\' http://localhost:9944\n'})}),"\n",(0,n.jsx)(s.h2,{id:"see-number-of-processes-at-a-certain-port",children:"see number of processes at a certain port"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"netstat -tn src :30333 | wc -l\n\n"})})]})}function p(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},534:(e,s,a)=>{"use strict";a.d(s,{A:()=>d});var t=a(6540),n=a(1620),o=a(3230);const r={kusama:[{name:"Stakeworld.io/01",stash:"CtEni6wrP7Kz2KWus9Y6vQWuhLqJpd9mQFTmTvw8T7FLui8"},{name:"Stakeworld.io/02",stash:"FZ1GFKR6tYx9gNGHV67h5aV6bfhAbh7ZRdU9ypVvXfseyfg"},{name:"Stakeworld.io/03",stash:"Dh2ZNKbQMdusURjfZZj7Bczb57PGEoCVmDHdq8hjnH5PZ4E"},{name:"Stakeworld.io/04",stash:"FNPCfXrsrA8775HGuRvK9seULKpcnxNTTKTGUL4h267YHvw"},{name:"Stakeworld.io/05",stash:"Hqk9zDKr84PF84ScDQJ29FHyGnKyQsXZPmLuAWFBgKZUybi"}],polkadot:[{name:"Stakeworld.io/01",stash:"14kpNbU4XjEHfYdqp95Gq3NkBWbgFd6J8Yjd2SneWNzvf1Yp"},{name:"Stakeworld.io/02",stash:"14ebRSbCJepTp2X3YwDsyE3wRRQ1RZYa8nEFnLxLe19qdHna"},{name:"Stakeworld.io/03",stash:"15MS9CHMMRtM5NQax9rAh2HTbmAehVdpEPMf4UzsBL6Mn6mz"},{name:"Stakeworld.io/04",stash:"13CKU6wfn1j3SB8ena6Heb3hgo35yCFtvkAotyCPpJRnEkFg"},{name:"Stakeworld.io/05",stash:"1RsqWYLNuHr9fw961TBABLM4R76mZSZEZv3ohWeiNE6Pixb"}]},i={kusama:["Kusama Assethub","Kusama Bridgehub","Kusama Coretime","Kusama Encointer","Kusama People"],polkadot:["Polkadot Assethub","Polkadot Bridgehub","Polkadot Collectives","Polkadot Coretime","Polkadot People"]};var l=a(4848);const d=()=>{const[e,s]=(0,t.useState)([]),[a,d]=(0,t.useState)([]),[c,h]=(0,t.useState)({}),[p,u]=(0,t.useState)(!0),[m,k]=(0,t.useState)(null),v=e=>{h((s=>({...s,[e]:!s[e]})))};return(0,t.useEffect)((()=>{(async()=>{try{console.log("Connecting to WebSocket providers...");const e=new n.E("wss://dot-rpc.stakeworld.io"),a=new n.E("wss://ksm-rpc.stakeworld.io"),[t,i]=await Promise.all([o.G.create({provider:e}),o.G.create({provider:a})]);console.log("Connected to APIs.");const l=async(e,s)=>{const a=await e.query.session.validators();return s.map((e=>{let{name:s,stash:t}=e;const n=a.some((e=>e.toString()===t));return{name:s,stash:t,isActive:n}}))},c=await l(i,r.kusama),h=await l(t,r.polkadot);s(c),d(h),u(!1)}catch(e){console.error("Error fetching validator data:",e),k("Failed to fetch validator data. Please try again later."),u(!1)}})()}),[]),p?(0,l.jsx)("p",{children:"Loading validator status..."}):m?(0,l.jsx)("p",{children:m}):(0,l.jsxs)("div",{className:"features",children:[(0,l.jsxs)("div",{className:"validator-column",children:[(0,l.jsx)("h2",{children:"Kusama Validators"}),e.map(((e,s)=>{const a=`Kusama-${e.name}`;return(0,l.jsxs)("div",{className:e.isActive?"green":"red",children:[(0,l.jsxs)("span",{onClick:()=>v(a),style:{cursor:"pointer",fontWeight:"bold"},children:[e.name," - ",e.isActive?"Active":"Inactive"]}),c[a]&&(0,l.jsx)("div",{children:(0,l.jsx)("a",{href:"https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fksm-rpc.stakeworld.io&filter=stakeworld",target:"_blank",rel:"noopener noreferrer",children:e.stash})})]},s)}))]}),(0,l.jsxs)("div",{className:"validator-column",children:[(0,l.jsx)("h2",{children:"Polkadot Validators"}),a.map(((e,s)=>{const a=`Polkadot-${e.name}`;return(0,l.jsxs)("div",{className:e.isActive?"green":"red",children:[(0,l.jsxs)("span",{onClick:()=>v(a),style:{cursor:"pointer",fontWeight:"bold"},children:[e.name," - ",e.isActive?"Active":"Inactive"]}),c[a]&&(0,l.jsx)("div",{children:(0,l.jsx)("a",{href:"https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fdot-rpc.stakeworld.io&filter=stakeworld",target:"_blank",rel:"noopener noreferrer",children:e.stash})})]},s)}))]}),(0,l.jsxs)("div",{className:"validator-column",children:[(0,l.jsx)("h2",{children:"Kusama Collators"}),i.kusama.map(((e,s)=>(0,l.jsx)("div",{className:"green",children:e},s)))]}),(0,l.jsxs)("div",{className:"validator-column",children:[(0,l.jsx)("h2",{children:"Polkadot Collators"}),i.polkadot.map(((e,s)=>(0,l.jsx)("div",{className:"green",children:e},s)))]})]})}},7790:()=>{},8453:(e,s,a)=>{"use strict";a.d(s,{R:()=>r,x:()=>i});var t=a(6540);const n={},o=t.createContext(n);function r(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);