"use strict";(self.webpackChunkstakeworld_io=self.webpackChunkstakeworld_io||[]).push([[953],{7838:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"validate","title":"Validators","description":"Setting up a validator node","source":"@site/docs/validate.mdx","sourceDirName":".","slug":"/validate","permalink":"/docs/validate","draft":false,"unlisted":false,"editUrl":"https://github.com/stakeworld/website/edit/master/docs/validate.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"validate","title":"Validators","description":"Setting up a validator node","slug":"/validate","sidebar_position":2,"keywords":["validator setup","validator","validate","polkadot","kusama"]},"sidebar":"tutorialSidebar","previous":{"title":"Database sizes","permalink":"/docs/dbsize"},"next":{"title":"Snapshots","permalink":"/docs/snapshot"}}');var t=a(4848),i=a(8453);const o={id:"validate",title:"Validators",description:"Setting up a validator node",slug:"/validate",sidebar_position:2,keywords:["validator setup","validator","validate","polkadot","kusama"]},r=void 0,l={},d=[{value:"Stakeworld",id:"stakeworld",level:2},{value:"Set up your own polkadot node",id:"set-up-your-own-polkadot-node",level:2},{value:"Firewall",id:"firewall",level:2},{value:"Packages",id:"packages",level:2},{value:"Install polkadot",id:"install-polkadot",level:2},{value:"Database sync",id:"database-sync",level:2},{value:"check if ports are open",id:"check-if-ports-are-open",level:2},{value:"see cpu frequencies",id:"see-cpu-frequencies",level:2},{value:"get more disk space by limiting reserved space for root",id:"get-more-disk-space-by-limiting-reserved-space-for-root",level:2},{value:"get disk space information",id:"get-disk-space-information",level:2},{value:"rotatekeys",id:"rotatekeys",level:2},{value:"check session keys",id:"check-session-keys",level:2},{value:"see number of processes at a certain port",id:"see-number-of-processes-at-a-certain-port",level:2}];function c(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h2,{id:"stakeworld",children:"Stakeworld"}),"\n",(0,t.jsx)(s.p,{children:"All stakeworld's validators are running on dedicated (bare bone) hardware in various datacentra."}),"\n",(0,t.jsxs)(s.p,{children:["They have at least the ",(0,t.jsx)(s.a,{href:"https://wiki.polkadot.network/docs/maintain-guides-how-to-validate-polkadot#requirements",children:"minimum hardware"})," specifications as advised by the polkadot wiki but most of the time better specifications."]}),"\n",(0,t.jsx)(s.h2,{id:"set-up-your-own-polkadot-node",children:"Set up your own polkadot node"}),"\n",(0,t.jsx)(s.p,{children:"First you will need a working server setup. We advise an ubuntu 24.04 LTS on dedicated (bare bone) hardware."}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.a,{href:"https://wiki.polkadot.network/docs/maintain-guides-how-to-validate-kusama",children:"polkadot wiki"})," has a lot of good information about seting up a validator node."]}),"\n",(0,t.jsx)(s.p,{children:"It is wise to start setting your hostname (preferably matched bij the reverse dns on your provider), copying your ssh keys to your server and disable plain password authentication."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"vi /etc/hostname\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.code,{children:"yourhostname.yourhostdomain"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"vi /etc/ssh/sshd_config\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.code,{children:"PasswordAuthentication no"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"systemctl restart sshd.service\n"})}),"\n",(0,t.jsx)(s.h2,{id:"firewall",children:"Firewall"}),"\n",(0,t.jsxs)(s.admonition,{type:"tip",children:[(0,t.jsx)(s.p,{children:"Polkadot needs some ports open in the firewall, especially the p2p port"}),(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"30333: p2p port"}),"\n",(0,t.jsx)(s.li,{children:"9933: HTTP RPC"}),"\n",(0,t.jsx)(s.li,{children:"9944: WS RPC"}),"\n",(0,t.jsx)(s.li,{children:"9615: prometheus port"}),"\n"]})]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"ufw allow openssh\nufw enable\nufw allow from any port 30300:30399 proto tcp\nufw allow 30300:30399/tcp\n"})}),"\n",(0,t.jsx)(s.h2,{id:"packages",children:"Packages"}),"\n",(0,t.jsx)(s.p,{children:"Optionally lock the kernel updates so you have to manually upgrade them (which requires a restart)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"apt-mark hold linux-generic linux-headers-generic linux-image-generic\n"})}),"\n",(0,t.jsx)(s.h2,{id:"install-polkadot",children:"Install polkadot"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Import the security@parity.io GPG key\ngpg --recv-keys --keyserver hkps://keys.mailvelope.com 9D4B2B6EB8F97156D19669A9FF0812D491B96798\ngpg --export 9D4B2B6EB8F97156D19669A9FF0812D491B96798 > /usr/share/keyrings/parity.gpg\n# Add the Parity repository and update the package index\necho 'deb [signed-by=/usr/share/keyrings/parity.gpg] https://releases.parity.io/deb release main' > /etc/apt/sources.list.d/parity.list\napt update\n# Install the `parity-keyring` package - This will ensure the GPG key\n# used by APT remains up-to-date\napt install parity-keyring\n# Install polkadot\napt install polkadot\n"})}),"\n",(0,t.jsx)(s.h2,{id:"database-sync",children:"Database sync"}),"\n",(0,t.jsx)(s.p,{children:"If you fire up a fresh polkadot it starts to sync from scratch, which will take a while. You can use warp sync to speed up the process or you can use a snapshot."}),"\n",(0,t.jsx)(s.h1,{id:"example-commands",children:"Example commands"}),"\n",(0,t.jsx)(s.p,{children:"Example ports and hosts used, change to your own setup."}),"\n",(0,t.jsx)(s.h2,{id:"check-if-ports-are-open",children:"check if ports are open"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"nc -vz 1.2.3.4 30333\n"})}),"\n",(0,t.jsx)(s.h2,{id:"see-cpu-frequencies",children:"see cpu frequencies"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"lscpu --all --extended\n"})}),"\n",(0,t.jsx)(s.h2,{id:"get-more-disk-space-by-limiting-reserved-space-for-root",children:"get more disk space by limiting reserved space for root"}),"\n",(0,t.jsx)(s.p,{children:"Default is 5% which is 50GB on a 1000 GB system, 0.1 (1GB) is more suitable."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"tune2fs -m0.1 /dev/<disk>\n"})}),"\n",(0,t.jsx)(s.h2,{id:"get-disk-space-information",children:"get disk space information"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"du -sh /home/polkadot/*\ndf -h\n"})}),"\n",(0,t.jsx)(s.h2,{id:"rotatekeys",children:"rotatekeys"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "author_rotateKeys", "params":[]}\' http://localhost:9944 > session.key\n'})}),"\n",(0,t.jsx)(s.h2,{id:"check-session-keys",children:"check session keys"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'curl -H "Content-Type: application/json" -d \'{"id":1, "jsonrpc":"2.0", "method": "author_hasSessionKeys", "params":["<session key 0x.....>"]}\' http://localhost:9944\n'})}),"\n",(0,t.jsx)(s.h2,{id:"see-number-of-processes-at-a-certain-port",children:"see number of processes at a certain port"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"netstat -tn src :30333 | wc -l\n\n"})})]})}function p(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>o,x:()=>r});var n=a(6540);const t={},i=n.createContext(t);function o(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);