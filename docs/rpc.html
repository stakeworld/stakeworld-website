<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-rpc" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Rpc servers | Stakeworld.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.stakeworld.io/docs/rpc"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rpc servers | Stakeworld.io"><meta data-rh="true" name="description" content="Setting up a secure RPC server"><meta data-rh="true" property="og:description" content="Setting up a secure RPC server"><meta data-rh="true" name="keywords" content="rpc,rpc server,wss,ws,polkadot.js,validator,polkadot,kusama,westend"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.stakeworld.io/docs/rpc"><link data-rh="true" rel="alternate" href="https://www.stakeworld.io/docs/rpc" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.stakeworld.io/docs/rpc" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Rpc servers","item":"https://www.stakeworld.io/docs/rpc"}]}</script><link rel="stylesheet" href="/assets/css/styles.05077510.css">
<script src="/assets/js/runtime~main.3dd35b6b.js" defer="defer"></script>
<script src="/assets/js/main.950a9de7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#f5f7bc" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">⭐️ If you like Stakeworld, nominate it on <a target="_blank" rel="noopener noreferrer" href="https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fksm-rpc.stakeworld.io&filter=stakeworld">Kusama</a> or <a target="_blank" rel="noopener noreferrer" href="https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fdot-rpc.stakeworld.io&filter=stakeworld">Polkadot</a> ⭐️</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/sw.png" alt="Stakeworld" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/sw.png" alt="Stakeworld" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Stakeworld</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/dbsize">Database sizes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/validate">Validators</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/snapshot">Snapshots</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/rpc">Public RPC</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fdot-rpc.stakeworld.io&amp;filter=stakeworld" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Nominate on Polkadot<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://polkadot.js.org/apps/#/staking/targets?rpc=wss%3A%2F%2Fksm-rpc.stakeworld.io&amp;filter=stakeworld" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Nominate on Kusama<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/validate">Validators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/snapshot">Snapshot</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/dbsize">Database sizes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/rpc">Rpc servers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/monitor">Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/disaster">Disaster managment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ledger">Ledger Wallet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/nominate">Nominate</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Rpc servers</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Rpc servers</h1></header><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>RPC servers allow access into the polkadot/kusama and parachains ecosystem. Stakeworld runs multiple public archive RPC servers:</p><ul>
<li>Polkadot: <a href="https://polkadot.js.org/apps/?rpc=wss://dot-rpc.stakeworld.io" target="_blank" rel="noopener noreferrer">dot-rpc.stakeworld.io</a>
<ul>
<li>AssetHub: <a href="https://polkadot.js.org/apps/?rpc=wss://dot-rpc.stakeworld.io/assethub" target="_blank" rel="noopener noreferrer">dot-rpc.stakeworld.io/assethub</a></li>
<li>BridgeHub: <a href="https://polkadot.js.org/apps/?rpc=wss://dot-rpc.stakeworld.io/bridgehub" target="_blank" rel="noopener noreferrer">dot-rpc.stakeworld.io/bridgehub</a></li>
<li>Collectives: <a href="https://polkadot.js.org/apps/?rpc=wss://dot-rpc.stakeworld.io/collectives" target="_blank" rel="noopener noreferrer">dot-rpc.stakeworld.io/collectives</a></li>
</ul>
</li>
<li>Kusama: <a href="https://polkadot.js.org/apps/?rpc=wss://ksm-rpc.stakeworld.io" target="_blank" rel="noopener noreferrer">ksm-rpc.stakeworld.io</a>
<ul>
<li>AssetHub: <a href="https://polkadot.js.org/apps/?rpc=wss://ksm-rpc.stakeworld.io/assethub" target="_blank" rel="noopener noreferrer">ksm-rpc.stakeworld.io/assethub</a></li>
<li>BridgeHub: <a href="https://polkadot.js.org/apps/?rpc=wss://ksm-rpc.stakeworld.io/bridgehub" target="_blank" rel="noopener noreferrer">ksm-rpc.stakeworld.io/bridgehub</a></li>
</ul>
</li>
<li>Paseo: <a href="https://polkadot.js.org/apps/?rpc=wss://pas-rpc.stakeworld.io" target="_blank" rel="noopener noreferrer">pas-rpc.stakeworld.io</a>
<ul>
<li>AssetHub: <a href="https://polkadot.js.org/apps/?rpc=wss://pas-rpc.stakeworld.io/assethub" target="_blank" rel="noopener noreferrer">pas-rpc.stakeworld.io/assethub</a></li>
</ul>
</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stakeworld-rpc-data">Stakeworld RPC data<a href="#stakeworld-rpc-data" class="hash-link" aria-label="Direct link to Stakeworld RPC data" title="Direct link to Stakeworld RPC data">​</a></h2>
<p>Last update: Sun 13 apr 2025</p>
<p>Requests in millions:</p>
<table><thead><tr><th>Chain</th><th>Requests in millions (6 months)</th><th>Requests in millions (per month)</th><th>Requests in millions (per day)</th></tr></thead><tbody><tr><td>ksmcc3</td><td>6526</td><td>1088</td><td>36</td></tr><tr><td>asset-hub-kusama</td><td>82</td><td>14</td><td>0</td></tr><tr><td>bridge-hub-kusama</td><td>31</td><td>5</td><td>0</td></tr><tr><td>coretime-kusama</td><td>13</td><td>2</td><td>0</td></tr><tr><td>encointer-kusama</td><td>31</td><td>5</td><td>0</td></tr><tr><td>people-kusama</td><td>223</td><td>37</td><td>1</td></tr><tr><td>polkadot</td><td>4689</td><td>782</td><td>26</td></tr><tr><td>asset-hub-polkadot</td><td>7188</td><td>1198</td><td>39</td></tr><tr><td>bridge-hub-polkadot</td><td>44</td><td>7</td><td>0</td></tr><tr><td>collectives_polkadot</td><td>12</td><td>2</td><td>0</td></tr><tr><td>coretime-polkadot</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><td>people-polkadot</td><td>N/A</td><td>N/A</td><td>N/A</td></tr><tr><td>paseo</td><td>77</td><td>13</td><td>0</td></tr><tr><td>asset-hub-paseo</td><td>4</td><td>1</td><td>0</td></tr><tr><td>westend2</td><td>11</td><td>2</td><td>0</td></tr><tr><td>asset-hub-westend</td><td>1</td><td>0</td><td>0</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-your-own-secure-rpc-server">Setting up your own secure RPC server<a href="#setting-up-your-own-secure-rpc-server" class="hash-link" aria-label="Direct link to Setting up your own secure RPC server" title="Direct link to Setting up your own secure RPC server">​</a></h2>
<p>To access the polkadot, kusama and parachains networks we need some kind of access into the network. This can be achieved by <a href="/docs/validate">setting up a node</a> with a RPC server and allowing access to that RPC server via a secure websocket (wss) port. The default node setup already exposes a non secure ws socket on port 9944 (which can optionally be changed by the <code>--ws-port</code> parameter), but for a more usable situation we need a secure websocket which is accesible through a public port.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="archive-node-vs-pruned-node">Archive node vs pruned node<a href="#archive-node-vs-pruned-node" class="hash-link" aria-label="Direct link to Archive node vs pruned node" title="Direct link to Archive node vs pruned node">​</a></h3>
<p>A pruned node knows only the recent information about the network and not its full history. Most frequently done actions can be done with a pruned node, for example see account balances, make transfers, setup session keys, staking, etc. An archive node has the full history (database) of the network and can be queried in all kind of ways, give information about transfers since the network started, historical balances, advanced queries about past events, etc.</p>
<p>An archive node requires a lot more <a href="/docs/snapshot">diskspace</a>.  For an archive node you need the options <code>--state-pruning archive --blocks-pruning archive</code> in your startup settings.
<img decoding="async" loading="lazy" alt="snapsize" src="/assets/images/snapsize-feb249469c243663c982526d6df37234.png" width="800" height="300" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Inclusion in the Polkadot.js UI requires an archive node.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-the-rpc-server">Secure the RPC server<a href="#secure-the-rpc-server" class="hash-link" aria-label="Direct link to Secure the RPC server" title="Direct link to Secure the RPC server">​</a></h3>
<p>Via the node startup settings you can choose <strong>what</strong> to expose with <strong>how many</strong> connections <strong>from where</strong> through your rpc server.</p>
<p><em>How many</em>: You can set your maximum connections through <code>--ws-max-connections</code>, for example <code>--ws-max-connections 100</code></p>
<p><em>From where</em>: by default localhost and the polkadot.js are allowed to access the RPC server, you can change this by setting <code>--rpc-cors</code>, to allow access from everywhere you need <code>--rpc-cors all</code></p>
<p><em>What</em>: you can limit the methods to use with <code>--rpc-methods</code>, an easy way to set this to a safe mode is <code>--rpc-methods Safe</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-the-ws-port">Secure the ws port<a href="#secure-the-ws-port" class="hash-link" aria-label="Direct link to Secure the ws port" title="Direct link to Secure the ws port">​</a></h3>
<p>The ws port is preferably exposed from the outside as a ssl secured wss port. The &quot;<a href="https://wiki.polkadot.network/docs/maintain-wss" target="_blank" rel="noopener noreferrer">maintain wss</a>&quot; on the wiki already covers a lot of information about this, especially in relation to setting it up in a nginx configuration. This page is focussed more on a apache2 but principles are the same. The main idea is converting the non secure ws port to a secure wss port by putting it behind a ssl enabled proxy. So from outside one see&#x27;s the ssl enabled apache2/nginx/other proxy server, witch redirect the request to the internal rpc node.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-apache2-for-proxying">Using Apache2 for proxying<a href="#using-apache2-for-proxying" class="hash-link" aria-label="Direct link to Using Apache2 for proxying" title="Direct link to Using Apache2 for proxying">​</a></h3>
<p>Apache2 is a little heavier then nginx but also has some more tweaking posibilities. You can run it in different modes, prefork, worker or event. We chose <a href="https://httpd.apache.org/docs/2.4/mod/event.html" target="_blank" rel="noopener noreferrer">event</a> since this seems best suited for high load enviroments. Downside is that you can&#x27;t use the default php module and need to enable it via php-fm. The proxy_wstunnel module works out of the box.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apt install apache2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">a2dismod mpm_prefork</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">a2enmod mpm_event proxy proxy_html proxy_http proxy_wstunnel rewrite ssl</span><br></span></code></pre></div></div>
<p>If you want to enable php</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apt install php-fpm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">a2enmod proxy_fcgi setenvif</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-ssl-through-letsencrypt">Enabling ssl through letsencrypt<a href="#enabling-ssl-through-letsencrypt" class="hash-link" aria-label="Direct link to Enabling ssl through letsencrypt" title="Direct link to Enabling ssl through letsencrypt">​</a></h4>
<p>There are multiple options for getting a ssl certificate, one popular (and free) being letsencrypt. Obtaining a letsencrypt certificate can be done through for example <a href="https://certbot.eff.org/" target="_blank" rel="noopener noreferrer">certbot</a> or <a href="https://go-acme.github.io/lego/dns/" target="_blank" rel="noopener noreferrer">lego</a> (which has more dns provider options).</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="add-the-proxy-to-the-apache2-config">Add the proxy to the apache2 config<a href="#add-the-proxy-to-the-apache2-config" class="hash-link" aria-label="Direct link to Add the proxy to the apache2 config" title="Direct link to Add the proxy to the apache2 config">​</a></h4>
<p>The <a href="https://httpd.apache.org/docs/2.4/mod/mod_proxy_wstunnel.html" target="_blank" rel="noopener noreferrer">mod_proxy_wstunnel</a> provides <em>support for the tunnelling of web socket connections to a backend websockets server. The connection is automatically upgraded to a websocket connection</em>. In a ssl enabled virtualhost add:</p>
<div class="language-apacheconf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-apacheconf codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">SSLProxyEngine on</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ProxyRequests off</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ProxyPass / ws://localhost:9944</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ProxyPassReverse / ws://localhost:9944</span><br></span></code></pre></div></div>
<p>Older versions of mod_proxy_wstunnel do not upgrade the connection automatically and will need the following config added:</p>
<div class="language-apacheconf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-apacheconf codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">RewriteEngine on</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RewriteCond %{HTTP:Upgrade} websocket [NC]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RewriteRule /(.*) ws://localhost:9944/$1 [P,L]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RewriteRule /(.*) http://localhost:9944/$1 [P,L]</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="tweaking-connections">Tweaking connections<a href="#tweaking-connections" class="hash-link" aria-label="Direct link to Tweaking connections" title="Direct link to Tweaking connections">​</a></h4>
<p>The number of connections is limited by the node itself (<code>--ws-max-connections</code>) but also by the number of threads available on the proxy server. For apache2 this can be tweaked by editing <code>/etc/apache2/mods-enabled/mpm_event.conf</code></p>
<p>We are using:</p>
<div class="language-apacheconf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-apacheconf codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">StartServers		 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MinSpareThreads		 25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MaxSpareThreads		 75</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ThreadLimit		 128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ThreadsPerChild		 128</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MaxRequestWorkers  	 896</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MaxConnectionsPerChild   0</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rate-limiting">Rate limiting<a href="#rate-limiting" class="hash-link" aria-label="Direct link to Rate limiting" title="Direct link to Rate limiting">​</a></h4>
<p>Theoretically one client could use all connections/resources, draining the resources of the server and making it inaccessible. This can be countered by rate limiting the connections, for example by using mod_qos:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">apt install libapache2-mod-qos</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">a2enmod qos</span><br></span></code></pre></div></div>
<p>And edit <code>/etc/apache2/mods-available/qos.conf</code></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">  # allows max 50 connections from a single ip address:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  QS_SrvMaxConnPerIP                                 50</span><br></span></code></pre></div></div>
<p>Be carefull when running behind a load balancer (for example cloudflare) because the load balancer will only use a few ip&#x27;s and thus can trigger the rate limit, iso in this case it is better to use the rate limit options from the load balancer itself.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-balancing--failover">Load balancing &amp; failover<a href="#load-balancing--failover" class="hash-link" aria-label="Direct link to Load balancing &amp; failover" title="Direct link to Load balancing &amp; failover">​</a></h3>
<p>With multiple servers it is possible to build a load balancing or even a failover construction. A simple load balancing can be a <a href="https://en.wikipedia.org/wiki/Round-robin_DNS" target="_blank" rel="noopener noreferrer">round robin-robin dns</a> up to a more advanced (dedicated) load balancer or a content delivery network (CDN) like cloudflare.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stress-testing">Stress testing<a href="#stress-testing" class="hash-link" aria-label="Direct link to Stress testing" title="Direct link to Stress testing">​</a></h3>
<p>You can test basic usage by accessing your server through the polkadot.js UI as a custom endpoint. For example staking target display is RPC intensive and can give you an indication of performance.</p>
<p>There are also more dedicated stress testing solutions, we have forked the <a href="https://github.com/dwellir-public/artillery-engine-substrate" target="_blank" rel="noopener noreferrer">Dwellir repository</a> for our testing.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">nvm install --lts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">npm install -g yarn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yarn global add artillery</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yarn global add artillery-engine-substrate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">git clone git@github.com:stakeworld/stakeworld-rpc-artillery.git</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd /opt/stakeworld-rpc-artillery</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">yarn</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./run.sh</span><br></span></code></pre></div></div>
<p>After the <code>run.sh</code> you can edit some variables like how many connections per second, the wss node, etc. The following is a test run for 10 seconds with 10 connections per second and maximum 20 concurrent users.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  target: &quot;wss://ksm-rpc.stakeworld.io&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  processor: &quot;./functions.js&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  phases:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    - duration: 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      arrivalRate: 10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      maxVusers: 20</span><br></span></code></pre></div></div>
<p>After this you get some info about the run and a report is created, which can be used for further diagnostics</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Summary report @ 23:38:40(+0100)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.completed: .............................................................. 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.created: ................................................................ 100</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.created_by_name.balance: ................................................ 35</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.created_by_name.complex_call: ........................................... 33</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.created_by_name.headers_blocks: ......................................... 32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.failed: ................................................................. 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vusers.session_length:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  min: ......................................................................... 231.7</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  max: ......................................................................... 656.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  median: ...................................................................... 361.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  p95: ......................................................................... 518.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  p99: ......................................................................... 645.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ws.messages_sent: .............................................................. 163</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ws.send_rate: .................................................................. 29/sec</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Log file: reports/report.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Report generated: reports/report.html</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/stakeworld/website/edit/master/docs/rpc.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/dbsize"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database sizes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/monitor"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Monitoring</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#stakeworld-rpc-data" class="table-of-contents__link toc-highlight">Stakeworld RPC data</a></li><li><a href="#setting-up-your-own-secure-rpc-server" class="table-of-contents__link toc-highlight">Setting up your own secure RPC server</a><ul><li><a href="#archive-node-vs-pruned-node" class="table-of-contents__link toc-highlight">Archive node vs pruned node</a></li><li><a href="#secure-the-rpc-server" class="table-of-contents__link toc-highlight">Secure the RPC server</a></li><li><a href="#secure-the-ws-port" class="table-of-contents__link toc-highlight">Secure the ws port</a></li><li><a href="#using-apache2-for-proxying" class="table-of-contents__link toc-highlight">Using Apache2 for proxying</a></li><li><a href="#load-balancing--failover" class="table-of-contents__link toc-highlight">Load balancing &amp; failover</a></li><li><a href="#stress-testing" class="table-of-contents__link toc-highlight">Stress testing</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Services</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/snapshot">Snapshots</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/rpc">RPC</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dbsize">Database sizes</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Reference</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://wiki.polkadot.network/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Polkadot wiki<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://polkadot.js.org/apps/?rpc=wss://dot-rpc.stakeworld.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Polkadot.js<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:info@stakeworld.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">info@stakeworld.io<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/stakeworld" target="_blank" rel="noopener noreferrer" class="footer__link-item">github.com/stakeworld<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://app.element.io/#/user%2F%40stakeworld%3Amatrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">@stakeworld.matrix.org<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Main identities:<br> Kusama: Et9M3rrA7H2kHQEGRXHxufcp9HTEmFirMWtKHvjoJ85r1C9<br>Polkadot: 13Jpq4n3PXXaSAbJTMmFD78mXAzs8PzgUUQd5ve8saw7HQS5<br><br>Copyright © 2025</div></div></div></footer></div>
</body>
</html>